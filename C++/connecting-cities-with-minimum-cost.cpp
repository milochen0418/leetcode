class Solution {
    //https://leetcode.com/problems/connecting-cities-with-minimum-cost/
public:
    //typedef unordered_map< pair<int,int>, pair<int,int>, pair_hash> _parent_map;
    //typedef unordered_map< pair<int,int>, int, pair_hash> _size_map;
    vector<int> p;
    vector<int> sz; 
    int minimumCost(int n, vector<vector<int>>& connections) {
        sort(connections.begin(), connections.end(), [](auto& lhs, auto& rhs){
            return lhs[2] < rhs[2];
        });
        
        for(auto&e :connections) {
            printf("(%d,%d,%d)\n", e[0], e[1], e[2]);
        }
        cout<<"\n";
        
        p = vector<int>(n+1,0);
        sz = vector<int>(n+1,0);
        for(int i = 1;i<=n;i++) {
            sz[i] = 1;
            p[i] = i;
        }
        
        int cnt=0;
        int sum_cost=0;
        //for(auto&e :connections) {
        for(int i = 0;i<connections.size();i++) {
            vector<int> &e = connections[i];
            if(!UF_is_connected( p, e[0], e[1] )) { //not in same component
                UF_union(p,sz, e[0],e[1]);
                sum_cost += e[2];
                cnt+=1;
            }
            if(cnt >= n-1) break;
        }
        if(cnt<n-1) return -1;
        return sum_cost;
        //return 0;
    }
    
    int UF_find_root(vector<int>& p,int node) {
        while(p[node] != node) node = p[node];
        return node; 
    }
    bool UF_is_connected(vector<int>& p, int node1, int node2){
        int root1 = UF_find_root(p, node1);
        int root2 = UF_find_root(p, node2);
        return root1 == root2;
    }
    
    void UF_union(vector<int>& p, vector<int>& sz, int node1 , int node2) {
        int root1 = UF_find_root(p, node1);
        int root2 = UF_find_root(p, node1);
        if(root1==root2) return;
        if(sz[root1] <sz[root2]) {
            p[root1] = root2;
            sz[root2] += sz[root1];
        } else {
            p[root2] = root1;
            sz[root1] += sz[root2];
        }
        /*
        if(root1 == root2) return;
        p[root2] = root1;
        */

    }
};


/* failed test case
50
[[2,1,22135],[3,1,13746],[4,3,37060],[5,2,48513],[6,3,49607],[7,1,97197],[8,2,95909],[9,2,82668],[10,2,48372],[11,4,17775],[12,2,6017],[13,1,51409],[14,2,12884],[15,7,98902],[16,14,52361],[17,8,11588],[18,12,86814],[19,17,49581],[20,4,41808],[21,11,77039],[22,10,80279],[23,16,61659],[24,12,89390],[25,24,10042],[26,12,78278],[27,15,30756],[28,6,2883],[29,8,3478],[30,7,29321],[31,12,47542],[32,20,35806],[33,3,26531],[34,12,16321],[35,27,82484],[36,7,55920],[37,24,21253],[38,23,90537],[39,7,83795],[40,36,70353],[41,34,76983],[42,14,63416],[43,15,39590],[44,9,86794],[45,3,31968],[46,19,32695],[47,17,40287],[48,1,27993],[49,12,86349],[50,11,52080],[17,27,65829],[42,45,87517],[14,23,96130],[5,50,3601],[10,17,2017],[26,44,4118],[26,29,93146],[1,9,56934],[22,43,5984],[3,22,13404],[13,28,66475],[11,14,93296],[16,44,71637],[7,37,88398],[7,29,56056],[2,34,79170],[40,44,55496],[35,46,14494],[32,34,25143],[28,36,59961],[10,49,58317],[8,38,33783],[8,28,19762],[34,41,69590],[27,37,26831],[15,23,53060],[5,11,7570],[20,42,98814],[18,34,96014],[13,43,94702],[1,46,18873],[44,45,43666],[22,40,69729],[4,25,28548],[8,46,19305],[15,22,39749],[33,48,43826],[14,15,38867],[13,22,56073],[3,46,51377],[13,15,73530],[6,36,67511],[27,38,76774],[6,21,21673],[28,49,72219],[40,50,9568],[31,37,66173],[14,29,93641],[4,40,87301],[18,46,41318],[2,8,25717],[1,7,3006],[9,22,85003],[14,45,33961],[18,28,56248],[1,31,10007],[3,24,23971],[6,28,24448],[35,39,87474],[10,50,3371],[7,18,26351],[19,41,86238],[3,8,73207],[11,34,75438],[3,47,35394],[27,32,69991],[6,40,87955],[2,18,85693],[5,37,50456],[8,20,59182],[16,38,58363],[9,39,58494],[39,43,73017],[10,15,88526],[16,23,48361],[4,28,59995],[2,3,66426],[6,17,29387],[15,38,80738],[12,43,63014],[9,11,90635],[12,20,36051],[13,25,1515],[32,40,72665],[10,40,85644],[13,40,70642],[12,24,88771],[14,46,79583],[30,49,45432],[21,34,95097],[25,48,96934],[2,35,79611],[9,26,71147],[11,37,57109],[35,36,67266],[42,43,15913],[3,30,44704],[4,32,46266],[5,10,94508],[31,39,45742],[12,25,56618],[10,45,79396],[15,28,78005],[19,32,94010],[36,46,4417],[6,35,7762],[10,13,12161],[49,50,60013],[20,23,6891],[9,50,63893],[35,43,74832],[10,24,3562],[6,8,47831],[29,32,82689],[7,47,71961],[14,41,82402],[20,33,38732],[16,26,24131],[17,34,96267],[21,46,81067],[19,47,41426],[13,24,68768],[1,25,78243],[2,27,77645],[11,25,96335],[31,45,30726],[43,44,34801],[3,42,22953],[12,23,34898],[37,43,32324],[18,44,18539],[8,13,59737],[28,37,67994],[13,14,25013],[22,41,25671],[1,6,57657],[8,11,83932],[42,48,24122],[4,15,851],[9,29,70508],[7,32,53629],[3,4,34945],[2,32,64478],[7,30,75022],[14,19,55721],[20,22,84838],[22,25,6103],[8,49,11497],[11,32,22278],[35,44,56616],[12,49,18681],[18,43,56358],[24,43,13360],[24,47,59846],[28,43,36311],[17,25,63309],[1,14,30207],[39,48,22241],[13,26,94146],[4,33,62994],[40,48,32450],[8,19,8063],[20,29,56772],[10,27,21224],[24,30,40328],[44,46,48426],[22,45,39752],[6,43,96892],[2,30,73566],[26,36,43360],[34,36,51956],[18,20,5710],[7,22,72496],[3,39,9207],[15,30,39474],[11,35,82661],[12,50,84860],[14,26,25992],[16,39,33166],[25,41,11721],[19,40,68623],[27,28,98119],[19,43,3644],[8,16,84611],[33,42,52972],[29,36,60307],[9,36,44224],[9,48,89857],[25,26,21705],[29,33,12562],[5,34,32209],[9,16,26285],[22,37,80956],[18,35,51968],[37,49,36399],[18,42,37774],[1,30,24687],[23,43,55470],[6,47,69677],[21,39,6826],[15,24,38561]]


11
[[2,1,22135],[3,1,13746],[4,3,37060],[5,2,48513],[6,3,49607],[7,1,97197],[8,2,95909],[9,2,82668],[10,2,48372],[11,4,17775]]

40
[4,15,851],[13,25,1515],[10,17,2017],[28,6,2883],[1,7,3006],[10,40,3371],[29,8,3478],[10,24,3562],[5,40,3601],[19,40,3644],[26,40,4118],[36,40,4417],[18,20,5710],[22,40,5984],[12,2,6017],[22,25,6103],[21,39,6826],[20,23,6891],[5,11,7570],[6,35,7762],[8,19,8063],[3,39,9207],[40,5,9568],[1,31,10007],[25,24,10042],[8,40,11497],[17,8,11588],[25,40,11721],[10,13,12161],[29,33,12562],[14,2,12884],[24,40,13360],[3,22,13404],[3,1,13746],[35,40,14494],[1,40,15913],[34,12,16321],[11,4,17775],[18,40,18539],[12,40,18681],[1,40,18873],[8,40,19305],[8,28,19762],[10,27,21224],[37,24,21253],[6,21,21673],[25,26,21705],[2,1,22135],[39,40,22241],[11,32,22278],[3,40,22953],[3,24,23971],[1,40,24122],[16,26,24131],[6,28,24448],[1,30,24687],[13,14,25013],[32,34,25143],[22,40,25671],[2,8,25717],[14,26,25992],[9,16,26285],[7,18,26351],[33,3,26531],[27,37,26831],[2,5,27993],[4,25,28548],[30,7,29321],[6,17,29387],[1,14,30207],[31,40,30726],[27,15,30756],[1,3,31968],[5,34,32209],[37,40,32324],[40,5,32450],[1,19,32695],[16,39,33166],[8,38,33783],[14,40,33961],[1,40,34801],[12,23,34898],[3,4,34945],[3,40,35394],[32,20,35806],[12,20,36051],[28,40,36311],[37,40,36399],[4,3,37060],[18,40,37774],[15,24,38561],[20,33,38732],[14,15,38867],[15,30,39474],[1,15,39590],[15,22,39749],[22,40,39752],[1,17,40287],[24,30,40328],[18,40,41318],[19,40,41426],[20,4,41808],[26,36,43360],[1,40,43666],[33,40,43826],[9,36,44224],[3,30,44704],[30,40,45432],[31,39,45742],[4,32,46266],[31,12,47542],[6,8,47831],[16,23,48361],[10,2,48372],[1,40,48426],[5,2,48513],[19,17,49581],[6,3,49607],[5,37,50456],[3,40,51377],[13,1,51409],[34,36,51956],[18,35,51968],[1,11,52080],[16,14,52361],[33,40,52972],[15,23,53060],[7,32,53629],[23,40,55470],[40,5,55496],[14,19,55721],[36,7,55920],[7,29,56056],[13,22,56073],[18,28,56248],[18,40,56358],[35,40,56616],[12,25,56618],[20,29,56772],[1,9,56934],[11,37,57109],[1,6,57657],[10,40,58317],[16,38,58363],[9,39,58494],[8,20,59182],[8,13,59737],[24,40,59846],[28,36,59961],[4,28,59995],[1,40,60013],[29,36,60307],[23,16,61659],[4,33,62994],[12,40,63014],[17,25,63309],[1,14,63416],[9,40,63893],[2,32,64478],[17,27,65829],[31,37,66173],[2,3,66426],[13,28,66475],[35,36,67266],[6,36,67511],[28,37,67994],[19,40,68623],[13,24,68768],[34,40,69590],[6,40,69677],[22,40,69729],[27,32,69991],[40,36,70353],[9,29,70508],[13,40,70642],[9,26,71147],[16,40,71637],[7,40,71961],[28,40,72219],[7,22,72496],[32,40,72665],[39,40,73017],[3,8,73207],[13,15,73530],[2,30,73566],[35,40,74832],[7,30,75022],[11,34,75438],[27,38,76774],[1,34,76983],[21,11,77039],[2,27,77645],[15,28,78005],[1,25,78243],[26,12,78278],[2,34,79170],[10,40,79396],[14,40,79583],[2,35,79611],[22,10,80279],[15,38,80738],[22,37,80956],[21,40,81067],[14,40,82402],[35,27,82484],[11,35,82661],[9,2,82668],[29,32,82689],[39,7,83795],[8,11,83932],[8,16,84611],[20,22,84838],[12,40,84860],[9,22,85003],[10,40,85644],[2,18,85693],[19,40,86238],[1,12,86349],[1,9,86794],[18,12,86814],[4,40,87301],[35,39,87474],[1,40,87517],[6,40,87955],[7,37,88398],[10,15,88526],[12,24,88771],[24,12,89390],[9,40,89857],[38,23,90537],[9,11,90635],[26,29,93146],[11,14,93296],[14,29,93641],[19,32,94010],[13,26,94146],[5,10,94508],[13,40,94702],[21,34,95097],[8,2,95909],[18,34,96014],[14,23,96130],[17,34,96267],[11,25,96335],[6,40,96892],[25,40,96934],[7,1,97197],[27,28,98119],[20,40,98814],[15,7,98902]]

*/